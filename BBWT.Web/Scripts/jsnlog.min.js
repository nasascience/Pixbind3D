var __extends=this.__extends||function(b,c){function h(){this.constructor=b}for(var e in c)c.hasOwnProperty(e)&&(b[e]=c[e]);h.prototype=c.prototype;b.prototype=new h};function JL(b){if(!b)return JL.__;var c="";return("."+b).split(".").reduce(function(b,e){c=c?c+("."+e):e;var f=b["__"+c];void 0===f&&(JL.Logger.prototype=b,f=new JL.Logger(c),b["__"+c]=f);return f},JL.__)}
(function(b){function c(a,b,c){void 0!==b[a]&&(null===b[a]?delete c[a]:c[a]=b[a])}function h(a){if(null!=b.enabled&&!b.enabled)return!1;try{if(a.userAgentRegex&&!RegExp(a.userAgentRegex).test(navigator.userAgent))return!1}catch(c){}try{if(a.ipRegex&&b.clientIP&&!RegExp(a.ipRegex).test(b.clientIP))return!1}catch(j){}return!0}function e(a,b){try{if(a.disallow&&RegExp(a.disallow).test(b))return!1}catch(c){}return!0}b.enabled;b.clientIP;b.requestId;b.setOptions=function(a){c("enabled",a,this);c("clientIP",
a,this);c("requestId",a,this);return this};b.getAllLevel=function(){return-2147483648};b.getTraceLevel=function(){return 1E3};b.getDebugLevel=function(){return 2E3};b.getInfoLevel=function(){return 3E3};b.getWarnLevel=function(){return 4E3};b.getErrorLevel=function(){return 5E3};b.getFatalLevel=function(){return 6E3};b.getOffLevel=function(){return 2147483647};var f;f=function(a,b,c,d){this.l=a;this.m=b;this.n=c;this.t=d};b.LogItem=f;var g=function(a,c){this.appenderName=a;this.sendLogItems=c;this.level=
b.getTraceLevel();this.sendWithBufferLevel=2147483647;this.storeInBufferLevel=-2147483648;this.bufferSize=0;this.batchSize=1;this.buffer=[];this.batchBuffer=[]};g.prototype.setOptions=function(a){c("level",a,this);c("ipRegex",a,this);c("userAgentRegex",a,this);c("disallow",a,this);c("sendWithBufferLevel",a,this);c("storeInBufferLevel",a,this);c("bufferSize",a,this);c("batchSize",a,this);this.bufferSize<this.buffer.length&&(this.buffer.length=this.bufferSize);return this};g.prototype.log=function(a,
b,c){h(this)&&(e(this,b)&&!(a<this.storeInBufferLevel))&&(b=new f(a,b,c,(new Date).getTime()),a<this.level?0<this.bufferSize&&(this.buffer.push(b),this.buffer.length>this.bufferSize&&this.buffer.shift()):(!(a<this.sendWithBufferLevel)&&this.buffer.length&&(this.batchBuffer=this.batchBuffer.concat(this.buffer),this.buffer.length=0),this.batchBuffer.push(b),this.batchBuffer.length>=this.batchSize&&this.sendBatch()))};g.prototype.sendBatch=function(){0!=this.batchBuffer.length&&(this.sendLogItems(this.batchBuffer),
this.batchBuffer.length=0)};b.Appender=g;var k,i=function(a){g.call(this,a,i.prototype.sendLogItemsAjax);this.url="jsnlog.logger"};__extends(i,g);i.prototype.setOptions=function(a){c("url",a,this);g.prototype.setOptions.call(this,a);return this};i.prototype.sendLogItemsAjax=function(a){try{var c=JSON.stringify({r:b.requestId,lg:a}),j=new XMLHttpRequest;j.open("POST",this.url);j.setRequestHeader("Content-Type","application/json");j.send(c)}catch(d){}};k=i;b.AjaxAppender=k;var d=function(a){this.loggerName=
a;this.seenRegexes=[]};d.prototype.stringifyLogObject=function(a){switch(typeof a){case "string":return a;case "number":return a.toString();case "boolean":return a.toString();case "undefined":return"undefined";case "function":return a instanceof RegExp?a.toString():this.stringifyLogObject(a());case "object":return a instanceof RegExp||a instanceof String||a instanceof Number||a instanceof Boolean?a.toString():JSON.stringify(a);default:return"unknown"}};d.prototype.setOptions=function(a){c("level",
a,this);c("userAgentRegex",a,this);c("disallow",a,this);c("ipRegex",a,this);c("appenders",a,this);c("onceOnly",a,this);this.seenRegexes=[];return this};d.prototype.log=function(a,b){var c=0,d;if(!this.appenders)return this;if(a>=this.level&&h(this)&&(d=this.stringifyLogObject(b),e(this,d))){if(this.onceOnly)for(c=this.onceOnly.length-1;0<=c;){if(RegExp(this.onceOnly[c]).test(d)){if(this.seenRegexes[c])return this;this.seenRegexes[c]=!0}c--}for(c=this.appenders.length-1;0<=c;)this.appenders[c].log(a,
d,this.loggerName),c--}return this};d.prototype.trace=function(a){return this.log(1E3,a)};d.prototype.debug=function(a){return this.log(2E3,a)};d.prototype.info=function(a){return this.log(3E3,a)};d.prototype.warn=function(a){return this.log(4E3,a)};d.prototype.error=function(a){return this.log(5E3,a)};d.prototype.fatal=function(a){return this.log(6E3,a)};b.Logger=d;d=new k("");b.__=new b.Logger("");b.__.setOptions({level:b.getDebugLevel(),appenders:[d]});b.createAjaxAppender=function(a){return new k(a)}})(JL||
(JL={}));
